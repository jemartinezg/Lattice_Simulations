from Hamiltonian_Generation_Codebase._BaseCodeHam import *

from Hamiltonian_Generation_Codebase.state_initialization import *
from Hamiltonian_Generation_Codebase.time_evolution import *
from Hamiltonian_Generation_Codebase.Measurement_Functions import *

import matplotlib.pyplot as plt

plt.rcParams.update({'font.size': 25})
plotsize = (10, 6)
legend_size = 12
plt.rcParams["savefig.dpi"] = 300
plt.rcParams["savefig.bbox"] = 'tight'

#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
basis_labels = ['1a', '1b', '2a', '2b', '3a', '3b', '4a', '4b']

g = -1   #In MHz and time in us
U= 3.5
e = 0

coupling_dictionary_NN = {'aa': -2 * g, 'bb': 2 * g}     # Coupling to nearest unit cell
coupling_dictionary_same = {'ab' : g}  #Coupling within a unit cell
coupling_periodic = False #{'aa': 3 * g, 'ba': g, 'bb': 3 * g}


#one photon basis states
basis_states = RecursiveBasisState(4, basis_labels, state = '')
values_to_see = basis_states #plot all of the photon fock states
# initial_state = state_generation(basis_states, {'1a1a1a': (0.013690768-0j), '1a1a1b': (0.0755303879-0j), '1a1a2a': (-0.0484900235-0j), '1a1a2b': (-0.0001712278-0j), '1a1a3a': (-0.0483280617-0j), '1a1a3b': (-0.0753999194-0j), '1a1b1b': (0.0348905793-0j), '1a1b2a': (-0.0005168125-0j), '1a1b2b': (0.1487884197-0j), '1a1b3a': (-0.2808469975-0j), '1a1b3b': (-0.2752951269-0j), '1a2a2a': (-0.0483280617-0j), '1a2a2b': (-0.2808469975-0j), '1a2a3a': (0.2692711695-0j), '1a2a3b': (0.2814076211-0j), '1a2b2b': (-0.0912094311-0j), '1a2b3a': (0.2814076211-0j), '1a2b3b': (0.1498439421-0j), '1a3a3a': (-0.0484900235-0j), '1a3a3b': (-0.0005168125-0j), '1a3b3b': (0.0346072373-0j), '1b1b1b': (2.57017e-05-0j), '1b1b2a': (0.0346072373-0j), '1b1b2b': (0.04304595-0j), '1b1b3a': (-0.0912094311-0j), '1b1b3b': (-0.0432277069-0j), '1b2a2a': (-0.0753999194-0j), '1b2a2b': (-0.2752951269-0j), '1b2a3a': (0.2814076211+0j), '1b2a3b': (0.1498439421-0j), '1b2b2b': (-0.0432277069-0j), '1b2b3a': (0.1498439421-0j), '1b2b3b': (0.0005055037-0j), '1b3a3a': (-0.0001712278-0j), '1b3a3b': (0.1487884197-0j), '1b3b3b': (0.04304595-0j), '2a2a2a': (0.013690768-0j), '2a2a2b': (0.0755303879-0j), '2a2a3a': (-0.0484900235-0j), '2a2a3b': (-0.0001712278-0j), '2a2b2b': (0.0348905793-0j), '2a2b3a': (-0.0005168125-0j), '2a2b3b': (0.1487884197-0j), '2a3a3a': (-0.0483280617-0j), '2a3a3b': (-0.2808469975-0j), '2a3b3b': (-0.0912094311-0j), '2b2b2b': (2.57017e-05-0j), '2b2b3a': (0.0346072373-0j), '2b2b3b': (0.04304595-0j), '2b3a3a': (-0.0753999194-0j), '2b3a3b': (-0.2752951269-0j), '2b3b3b': (-0.0432277069-0j), '3a3a3a': (0.013690768-0j), '3a3a3b': (0.0755303879-0j), '3a3b3b': (0.0348905793-0j), '3b3b3b': (2.57017e-05-0j)}
# )

# All positive
initial_state = state_generation(basis_states, {'1a1a1a1a': (0.0006687888+0j), '1a1a1a1b': (-0.0034809773+0j), '1a1a1a2a': (-0.00422928+0j), '1a1a1a2b': (0.006464807+0j), '1a1a1a3a': (0.0064072837+0j), '1a1a1a3b': (-0.0077762223+0j), '1a1a1a4a': (-0.0049328599+0j), '1a1a1a4b': (0.005504926+0j), '1a1a1b1b': (0.0059695005+0j), '1a1a1b2a': (0.0169880841+0j), '1a1a1b2b': (-0.0198899408+0j), '1a1a1b3a': (-0.0242472814+0j), '1a1a1b3b': (0.0260810339+0j), '1a1a1b4a': (0.0182234235+0j), '1a1a1b4b': (-0.019000598+0j), '1a1a2a2a': (0.0112717458+0j), '1a1a2a2b': (-0.0293730106+0j), '1a1a2a3a': (-0.0269614675+0j), '1a1a2a3b': (0.0347792619+0j), '1a1a2a4a': (0.0214916088+0j), '1a1a2a4b': (-0.0246401835+0j), '1a1a2b2b': (0.0190567174+0j), '1a1a2b3a': (0.041388213+0j), '1a1a2b3b': (-0.0408534124+0j), '1a1a2b4a': (-0.0311715598+0j), '1a1a2b4b': (0.0311837153+0j), '1a1a3a3a': (0.0186919251+0j), '1a1a3a3b': (-0.0443745293+0j), '1a1a3a4a': (-0.0247986715+0j), '1a1a3a4b': (0.0311203249+0j), '1a1a3b3b': (0.02392098+0j), '1a1a3b4a': (0.0332423514+0j), '1a1a3b4b': (-0.0302100723+0j), '1a1a4a4a': (0.0092356741+0j), '1a1a4a4b': (-0.0212759266+0j), '1a1a4b4b': (0.0106460206+0j), '1a1b1b1b': (-0.0034809773+0j), '1a1b1b2a': (-0.0198899408+0j), '1a1b1b2b': (0.0169880841+0j), '1a1b1b3a': (0.0260810339+0j), '1a1b1b3b': (-0.0242472814+0j), '1a1b1b4a': (-0.019000598+0j), '1a1b1b4b': (0.0182234235+0j), '1a1b2a2a': (-0.030743273+0j), '1a1b2a2b': (0.0625743268+0j), '1a1b2a3a': (0.0703148229+0j), '1a1b2a3b': (-0.0810010107+0j), '1a1b2a4a': (-0.054932701+0j), '1a1b2a4b': (0.0591036714+0j), '1a1b2b2b': (-0.030743273+0j), '1a1b2b3a': (-0.0810010107+0j), '1a1b2b3b': (0.0703148229+0j), '1a1b2b4a': (0.0591036714+0j), '1a1b2b4b': (-0.054932701+0j), '1a1b3a3a': (-0.0451410852+0j), '1a1b3a3b': (0.0953338344+0j), '1a1b3a4a': (0.058594857+0j), '1a1b3a4b': (-0.069118997+0j), '1a1b3b3b': (-0.0451410852+0j), '1a1b3b4a': (-0.069118997+0j), '1a1b3b4b': (0.058594857+0j), '1a1b4a4a': (-0.0212759266+0j), '1a1b4a4b': (0.0457877532+0j), '1a1b4b4b': (-0.0212759266+0j), '1a2a2a2a': (-0.0127899607+0j), '1a2a2a2b': (0.0486610116+0j), '1a2a2a3a': (0.0413239647+0j), '1a2a2a3b': (-0.0567685438+0j), '1a2a2a4a': (-0.034286806+0j), '1a2a2a4b': (0.0403610164+0j), '1a2a2b2b': (-0.0554370857+0j), '1a2a2b3a': (-0.1105809407+0j), '1a2a2b3b': (0.1173931777+0j), '1a2a2b4a': (0.0868002884+0j), '1a2a2b4b': (-0.0898278809+0j), '1a2a3a3a': (-0.0469212696+0j), '1a2a3a3b': (0.117270053+0j), '1a2a3a4a': (0.0644372102+0j), '1a2a3a4b': (-0.0824504286+0j), '1a2a3b3b': (-0.0677449593+0j), '1a2a3b4a': (-0.091490309+0j), '1a2a3b4b': (0.0857745192+0j), '1a2a4a4a': (-0.0247986715+0j), '1a2a4a4b': (0.058594857+0j), '1a2a4b4b': (-0.0302100723+0j), '1a2b2b2b': (0.0185158439+0j), '1a2b2b3a': (0.0707782309+0j), '1a2b2b3b': (-0.0572145349+0j), '1a2b2b4a': (-0.0518606403+0j), '1a2b2b4b': (0.0467106831+0j), '1a2b3a3a': (0.070120266+0j), '1a2b3a3b': (-0.1370528001+0j), '1a2b3a4a': (-0.091490309+0j), '1a2b3a4b': (0.1041744311+0j), '1a2b3b3b': (0.0609265248+0j), '1a2b3b4a': (0.099689994+0j), '1a2b3b4b': (-0.0824504286+0j), '1a2b4a4a': (0.0332423514+0j), '1a2b4a4b': (-0.069118997+0j), '1a2b4b4b': (0.0311203249+0j), '1a3a3a3a': (0.0183290104+0j), '1a3a3a3b': (-0.0670876648+0j), '1a3a3a4a': (-0.034286806+0j), '1a3a3a4b': (0.0467106831+0j), '1a3a3b3b': (0.0718009702+0j), '1a3a3b4a': (0.0868002884+0j), '1a3a3b4b': (-0.0898278809+0j), '1a3a4a4a': (0.0214916088+0j), '1a3a4a4b': (-0.054932701+0j), '1a3a4b4b': (0.0311837153+0j), '1a3b3b3b': (-0.0220213897+0j), '1a3b3b4a': (-0.0518606403+0j), '1a3b3b4b': (0.0403610164+0j), '1a3b4a4a': (-0.0311715598+0j), '1a3b4a4b': (0.0591036714+0j), '1a3b4b4b': (-0.0246401835+0j), '1a4a4a4a': (-0.0049328599+0j), '1a4a4a4b': (0.0182234235+0j), '1a4a4b4b': (-0.019000598+0j), '1a4b4b4b': (0.005504926+0j), '1b1b1b1b': (0.0006687888+0j), '1b1b1b2a': (0.006464807+0j), '1b1b1b2b': (-0.00422928+0j), '1b1b1b3a': (-0.0077762223+0j), '1b1b1b3b': (0.0064072837+0j), '1b1b1b4a': (0.005504926+0j), '1b1b1b4b': (-0.0049328599+0j), '1b1b2a2a': (0.0190567174+0j), '1b1b2a2b': (-0.0293730106+0j), '1b1b2a3a': (-0.0408534124+0j), '1b1b2a3b': (0.041388213+0j), '1b1b2a4a': (0.0311837153+0j), '1b1b2a4b': (-0.0311715598+0j), '1b1b2b2b': (0.0112717458+0j), '1b1b2b3a': (0.0347792619+0j), '1b1b2b3b': (-0.0269614675+0j), '1b1b2b4a': (-0.0246401835+0j), '1b1b2b4b': (0.0214916088+0j), '1b1b3a3a': (0.02392098+0j), '1b1b3a3b': (-0.0443745293+0j), '1b1b3a4a': (-0.0302100723+0j), '1b1b3a4b': (0.0332423514+0j), '1b1b3b3b': (0.0186919251+0j), '1b1b3b4a': (0.0311203249+0j), '1b1b3b4b': (-0.0247986715+0j), '1b1b4a4a': (0.0106460206+0j), '1b1b4a4b': (-0.0212759266+0j), '1b1b4b4b': (0.0092356741+0j), '1b2a2a2a': (0.0185158439+0j), '1b2a2a2b': (-0.0554370857+0j), '1b2a2a3a': (-0.0572145349+0j), '1b2a2a3b': (0.0707782309+0j), '1b2a2a4a': (0.0467106831+0j), '1b2a2a4b': (-0.0518606403+0j), '1b2a2b2b': (0.0486610116+0j), '1b2a2b3a': (0.1173931777+0j), '1b2a2b3b': (-0.1105809407+0j), '1b2a2b4a': (-0.0898278809+0j), '1b2a2b4b': (0.0868002884+0j), '1b2a3a3a': (0.0609265248+0j), '1b2a3a3b': (-0.1370528001+0j), '1b2a3a4a': (-0.0824504286+0j), '1b2a3a4b': (0.099689994+0j), '1b2a3b3b': (0.070120266+0j), '1b2a3b4a': (0.1041744311+0j), '1b2a3b4b': (-0.091490309+0j), '1b2a4a4a': (0.0311203249+0j), '1b2a4a4b': (-0.069118997+0j), '1b2a4b4b': (0.0332423514+0j), '1b2b2b2b': (-0.0127899607+0j), '1b2b2b3a': (-0.0567685438+0j), '1b2b2b3b': (0.0413239647+0j), '1b2b2b4a': (0.0403610164+0j), '1b2b2b4b': (-0.034286806+0j), '1b2b3a3a': (-0.0677449593+0j), '1b2b3a3b': (0.117270053+0j), '1b2b3a4a': (0.0857745192+0j), '1b2b3a4b': (-0.091490309+0j), '1b2b3b3b': (-0.0469212696+0j), '1b2b3b4a': (-0.0824504286+0j), '1b2b3b4b': (0.0644372102+0j), '1b2b4a4a': (-0.0302100723+0j), '1b2b4a4b': (0.058594857+0j), '1b2b4b4b': (-0.0247986715+0j), '1b3a3a3a': (-0.0220213897+0j), '1b3a3a3b': (0.0718009702+0j), '1b3a3a4a': (0.0403610164+0j), '1b3a3a4b': (-0.0518606403+0j), '1b3a3b3b': (-0.0670876648+0j), '1b3a3b4a': (-0.0898278809+0j), '1b3a3b4b': (0.0868002884+0j), '1b3a4a4a': (-0.0246401835+0j), '1b3a4a4b': (0.0591036714+0j), '1b3a4b4b': (-0.0311715598+0j), '1b3b3b3b': (0.0183290104+0j), '1b3b3b4a': (0.0467106831+0j), '1b3b3b4b': (-0.034286806+0j), '1b3b4a4a': (0.0311837153+0j), '1b3b4a4b': (-0.054932701+0j), '1b3b4b4b': (0.0214916088+0j), '1b4a4a4a': (0.005504926+0j), '1b4a4a4b': (-0.019000598+0j), '1b4a4b4b': (0.0182234235+0j), '1b4b4b4b': (-0.0049328599+0j), '2a2a2a2a': (0.0053001787+0j), '2a2a2a2b': (-0.0265931973+0j), '2a2a2a3a': (-0.0212240992+0j), '2a2a2a3b': (0.0307429176+0j), '2a2a2a4a': (0.0183290104+0j), '2a2a2a4b': (-0.0220213897+0j), '2a2a2b2b': (0.0447931614+0j), '2a2a2b3a': (0.0816590792+0j), '2a2a2b3b': (-0.0934007541+0j), '2a2a2b4a': (-0.0670876648+0j), '2a2a2b4b': (0.0718009702+0j), '2a2a3a3a': (0.0330196725+0j), '2a2a3a3b': (-0.0860233678+0j), '2a2a3a4a': (-0.0469212696+0j), '2a2a3a4b': (0.0609265248+0j), '2a2a3b3b': (0.0532085281+0j), '2a2a3b4a': (0.070120266+0j), '2a2a3b4b': (-0.0677449593+0j), '2a2a4a4a': (0.0186919251+0j), '2a2a4a4b': (-0.0451410852+0j), '2a2a4b4b': (0.02392098+0j), '2a2b2b2b': (-0.0265931973+0j), '2a2b2b3a': (-0.0934007541+0j), '2a2b2b3b': (0.0816590792+0j), '2a2b2b4a': (0.0718009702+0j), '2a2b2b4b': (-0.0670876648+0j), '2a2b3a3a': (-0.0860233678+0j), '2a2b3a3b': (0.1795145371+0j), '2a2b3a4a': (0.117270053+0j), '2a2b3a4b': (-0.1370528001+0j), '2a2b3b3b': (-0.0860233678+0j), '2a2b3b4a': (-0.1370528001+0j), '2a2b3b4b': (0.117270053+0j), '2a2b4a4a': (-0.0443745293+0j), '2a2b4a4b': (0.0953338344+0j), '2a2b4b4b': (-0.0443745293+0j), '2a3a3a3a': (-0.0212240992+0j), '2a3a3a3b': (0.0816590792+0j), '2a3a3a4a': (0.0413239647+0j), '2a3a3a4b': (-0.0572145349+0j), '2a3a3b3b': (-0.0934007541+0j), '2a3a3b4a': (-0.1105809407+0j), '2a3a3b4b': (0.1173931777+0j), '2a3a4a4a': (-0.0269614675+0j), '2a3a4a4b': (0.0703148229+0j), '2a3a4b4b': (-0.0408534124+0j), '2a3b3b3b': (0.0307429176+0j), '2a3b3b4a': (0.0707782309+0j), '2a3b3b4b': (-0.0567685438+0j), '2a3b4a4a': (0.041388213+0j), '2a3b4a4b': (-0.0810010107+0j), '2a3b4b4b': (0.0347792619+0j), '2a4a4a4a': (0.0064072837+0j), '2a4a4a4b': (-0.0242472814+0j), '2a4a4b4b': (0.0260810339+0j), '2a4b4b4b': (-0.0077762223+0j), '2b2b2b2b': (0.0053001787+0j), '2b2b2b3a': (0.0307429176+0j), '2b2b2b3b': (-0.0212240992+0j), '2b2b2b4a': (-0.0220213897+0j), '2b2b2b4b': (0.0183290104+0j), '2b2b3a3a': (0.0532085281+0j), '2b2b3a3b': (-0.0860233678+0j), '2b2b3a4a': (-0.0677449593+0j), '2b2b3a4b': (0.070120266+0j), '2b2b3b3b': (0.0330196725+0j), '2b2b3b4a': (0.0609265248+0j), '2b2b3b4b': (-0.0469212696+0j), '2b2b4a4a': (0.02392098+0j), '2b2b4a4b': (-0.0451410852+0j), '2b2b4b4b': (0.0186919251+0j), '2b3a3a3a': (0.0307429176+0j), '2b3a3a3b': (-0.0934007541+0j), '2b3a3a4a': (-0.0567685438+0j), '2b3a3a4b': (0.0707782309+0j), '2b3a3b3b': (0.0816590792+0j), '2b3a3b4a': (0.1173931777+0j), '2b3a3b4b': (-0.1105809407+0j), '2b3a4a4a': (0.0347792619+0j), '2b3a4a4b': (-0.0810010107+0j), '2b3a4b4b': (0.041388213+0j), '2b3b3b3b': (-0.0212240992+0j), '2b3b3b4a': (-0.0572145349+0j), '2b3b3b4b': (0.0413239647+0j), '2b3b4a4a': (-0.0408534124+0j), '2b3b4a4b': (0.0703148229+0j), '2b3b4b4b': (-0.0269614675+0j), '2b4a4a4a': (-0.0077762223+0j), '2b4a4a4b': (0.0260810339+0j), '2b4a4b4b': (-0.0242472814+0j), '2b4b4b4b': (0.0064072837+0j), '3a3a3a3a': (0.0053001787+0j), '3a3a3a3b': (-0.0265931973+0j), '3a3a3a4a': (-0.0127899607+0j), '3a3a3a4b': (0.0185158439+0j), '3a3a3b3b': (0.0447931614+0j), '3a3a3b4a': (0.0486610116+0j), '3a3a3b4b': (-0.0554370857+0j), '3a3a4a4a': (0.0112717458+0j), '3a3a4a4b': (-0.030743273+0j), '3a3a4b4b': (0.0190567174+0j), '3a3b3b3b': (-0.0265931973+0j), '3a3b3b4a': (-0.0554370857+0j), '3a3b3b4b': (0.0486610116+0j), '3a3b4a4a': (-0.0293730106+0j), '3a3b4a4b': (0.0625743268+0j), '3a3b4b4b': (-0.0293730106+0j), '3a4a4a4a': (-0.00422928+0j), '3a4a4a4b': (0.0169880841+0j), '3a4a4b4b': (-0.0198899408+0j), '3a4b4b4b': (0.006464807+0j), '3b3b3b3b': (0.0053001787+0j), '3b3b3b4a': (0.0185158439+0j), '3b3b3b4b': (-0.0127899607+0j), '3b3b4a4a': (0.0190567174+0j), '3b3b4a4b': (-0.030743273+0j), '3b3b4b4b': (0.0112717458+0j), '3b4a4a4a': (0.006464807+0j), '3b4a4a4b': (-0.0198899408+0j), '3b4a4b4b': (0.0169880841+0j), '3b4b4b4b': (-0.00422928+0j), '4a4a4a4a': (0.0006687888+0j), '4a4a4a4b': (-0.0034809773+0j), '4a4a4b4b': (0.0059695005+0j), '4a4b4b4b': (-0.0034809773+0j), '4b4b4b4b': (0.0006687888+0j)}
)

#all positive, one negative
initial_state = state_generation(basis_states, {'1a1a1a1a': (-0.0001288136+0j), '1a1a1a1b': (0.0024517907+0j), '1a1a1a2a': (0.0001667163+0j), '1a1a1a2b': (-0.0055951751+0j), '1a1a1a3a': (-0.0012983659+0j), '1a1a1a3b': (0.0064864211+0j), '1a1a1a4a': (0.0005971137+0j), '1a1a1a4b': (-0.0043252782+0j), '1a1a1b1b': (-0.0094112282+0j), '1a1a1b2a': (0.005887707+0j), '1a1a1b2b': (0.0293041916+0j), '1a1a1b3a': (0.016650419+0j), '1a1a1b3b': (-0.039805856+0j), '1a1a1b4a': (0.0024135147+0j), '1a1a1b4b': (0.0255645362+0j), '1a1a2a2a': (0.0023366998+0j), '1a1a2a2b': (-0.0163038217+0j), '1a1a2a3a': (0.0013646673+0j), '1a1a2a3b': (0.0159197983+0j), '1a1a2a4a': (0.0045672247+0j), '1a1a2a4b': (-0.011256943+0j), '1a1a2b2b': (-0.0218115313+0j), '1a1a2b3a': (-0.0320876144+0j), '1a1a2b3b': (0.0512090902+0j), '1a1a2b4a': (-0.0102288161+0j), '1a1a2b4b': (-0.032502119+0j), '1a1a3a3a': (-0.0035856451+0j), '1a1a3a3b': (0.0330382203+0j), '1a1a3a4a': (0.0026557878+0j), '1a1a3a4b': (-0.0224713829+0j), '1a1a3b3b': (-0.0290926893+0j), '1a1a3b4a': (0.011704268+0j), '1a1a3b4b': (0.0300724961+0j), '1a1a4a4a': (0.0022873491+0j), '1a1a4a4b': (-0.0099650011+0j), '1a1a4b4b': (-0.0075134083+0j), '1a1b1b1b': (0.0024517907+0j), '1a1b1b2a': (-0.0293041916+0j), '1a1b1b2b': (-0.005887707+0j), '1a1b1b3a': (-0.039805856+0j), '1a1b1b3b': (0.016650419+0j), '1a1b1b4a': (-0.0255645362+0j), '1a1b1b4b': (-0.0024135147+0j), '1a1b2a2a': (-0.0032009141+0j), '1a1b2a2b': (0.0945748618+0j), '1a1b2a3a': (0.0190249446+0j), '1a1b2a3b': (-0.119954262+0j), '1a1b2a4a': (-0.0145466323+0j), '1a1b2a4b': (0.084472571+0j), '1a1b2b2b': (-0.0032009141+0j), '1a1b2b3a': (0.119954262+0j), '1a1b2b3b': (-0.0190249446+0j), '1a1b2b4a': (0.084472571+0j), '1a1b2b4b': (-0.0145466323+0j), '1a1b3a3a': (0.0298775513+0j), '1a1b3a3b': (-0.1565197669+0j), '1a1b3a4a': (0.0044123194+0j), '1a1b3a4b': (0.1031824802+0j), '1a1b3b3b': (0.0298775513+0j), '1a1b3b4a': (-0.1031824802+0j), '1a1b3b4b': (-0.0044123194+0j), '1a1b4a4a': (-0.0099650011+0j), '1a1b4a4b': (0.074163922+0j), '1a1b4b4b': (-0.0099650011+0j), '1a2a2a2a': (0.0024250907+0j), '1a2a2a2b': (-0.0043851343+0j), '1a2a2a3a': (0.0076589785+0j), '1a2a2a3b': (-0.0039311239+0j), '1a2a2a4a': (0.0045309319+0j), '1a2a2a4b': (0.0025113326+0j), '1a2a2b2b': (-0.0749123142+0j), '1a2a2b3a': (-0.0421366254+0j), '1a2a2b3b': (0.1613810976+0j), '1a2a2b4a': (0.0093740183+0j), '1a2a2b4b': (-0.1161714692+0j), '1a2a3a3a': (0.0034898914+0j), '1a2a3a3b': (0.0270592375+0j), '1a2a3a4a': (0.0109190977+0j), '1a2a3a4b': (-0.0207431125+0j), '1a2a3b3b': (-0.0815626111+0j), '1a2a3b4a': (-0.01397448+0j), '1a2a3b4b': (0.0980316525+0j), '1a2a4a4a': (0.0026557878+0j), '1a2a4a4b': (0.0044123194+0j), '1a2a4b4b': (-0.0300724961+0j), '1a2b2b2b': (0.0084256404+0j), '1a2b2b3a': (-0.0890648521+0j), '1a2b2b3b': (-0.0077802939+0j), '1a2b2b4a': (-0.068589584+0j), '1a2b2b4b': (0.0277459348+0j), '1a2b3a3a': (-0.0460957199+0j), '1a2b3a3b': (0.1976413701+0j), '1a2b3a4a': (-0.01397448+0j), '1a2b3a4b': (-0.1344413254+0j), '1a2b3b3b': (-0.0168877848+0j), '1a2b3b4a': (0.1396712889+0j), '1a2b3b4b': (-0.0207431125+0j), '1a2b4a4a': (0.011704268+0j), '1a2b4a4b': (-0.1031824802+0j), '1a2b4b4b': (0.0224713829+0j), '1a3a3a3a': (-0.0019387764+0j), '1a3a3a3b': (0.037115544+0j), '1a3a3a4a': (0.0045309319+0j), '1a3a3a4b': (-0.0277459348+0j), '1a3a3b3b': (-0.1025088577+0j), '1a3a3b4a': (0.0093740183+0j), '1a3a3b4b': (0.1161714692+0j), '1a3a4a4a': (0.0045672247+0j), '1a3a4a4b': (-0.0145466323+0j), '1a3a4b4b': (-0.032502119+0j), '1a3b3b3b': (0.0125040464+0j), '1a3b3b4a': (-0.068589584+0j), '1a3b3b4b': (-0.0025113326+0j), '1a3b4a4a': (-0.0102288161+0j), '1a3b4a4b': (0.084472571+0j), '1a3b4b4b': (-0.011256943+0j), '1a4a4a4a': (0.0005971137+0j), '1a4a4a4b': (0.0024135147+0j), '1a4a4b4b': (-0.0255645362+0j), '1a4b4b4b': (0.0043252782+0j), '1b1b1b1b': (-0.0001288136+0j), '1b1b1b2a': (0.0055951751+0j), '1b1b1b2b': (-0.0001667163+0j), '1b1b1b3a': (0.0064864211+0j), '1b1b1b3b': (-0.0012983659+0j), '1b1b1b4a': (0.0043252782+0j), '1b1b1b4b': (-0.0005971137+0j), '1b1b2a2a': (-0.0218115313+0j), '1b1b2a2b': (-0.0163038217+0j), '1b1b2a3a': (-0.0512090902+0j), '1b1b2a3b': (0.0320876144+0j), '1b1b2a4a': (-0.032502119+0j), '1b1b2a4b': (-0.0102288161+0j), '1b1b2b2b': (0.0023366998+0j), '1b1b2b3a': (-0.0159197983+0j), '1b1b2b3b': (-0.0013646673+0j), '1b1b2b4a': (-0.011256943+0j), '1b1b2b4b': (0.0045672247+0j), '1b1b3a3a': (-0.0290926893+0j), '1b1b3a3b': (0.0330382203+0j), '1b1b3a4a': (-0.0300724961+0j), '1b1b3a4b': (-0.011704268+0j), '1b1b3b3b': (-0.0035856451+0j), '1b1b3b4a': (0.0224713829+0j), '1b1b3b4b': (-0.0026557878+0j), '1b1b4a4a': (-0.0075134083+0j), '1b1b4a4b': (-0.0099650011+0j), '1b1b4b4b': (0.0022873491+0j), '1b2a2a2a': (-0.0084256404+0j), '1b2a2a2b': (0.0749123142+0j), '1b2a2a3a': (-0.0077802939+0j), '1b2a2a3b': (-0.0890648521+0j), '1b2a2a4a': (-0.0277459348+0j), '1b2a2a4b': (0.068589584+0j), '1b2a2b2b': (0.0043851343+0j), '1b2a2b3a': (0.1613810976+0j), '1b2a2b3b': (-0.0421366254+0j), '1b2a2b4a': (0.1161714692+0j), '1b2a2b4b': (-0.0093740183+0j), '1b2a3a3a': (0.0168877848+0j), '1b2a3a3b': (-0.1976413701+0j), '1b2a3a4a': (-0.0207431125+0j), '1b2a3a4b': (0.1396712889+0j), '1b2a3b3b': (0.0460957199+0j), '1b2a3b4a': (-0.1344413254+0j), '1b2a3b4b': (-0.01397448+0j), '1b2a4a4a': (-0.0224713829+0j), '1b2a4a4b': (0.1031824802+0j), '1b2a4b4b': (-0.011704268+0j), '1b2b2b2b': (-0.0024250907+0j), '1b2b2b3a': (-0.0039311239+0j), '1b2b2b3b': (0.0076589785+0j), '1b2b2b4a': (-0.0025113326+0j), '1b2b2b4b': (-0.0045309319+0j), '1b2b3a3a': (0.0815626111+0j), '1b2b3a3b': (-0.0270592375+0j), '1b2b3a4a': (0.0980316525+0j), '1b2b3a4b': (-0.01397448+0j), '1b2b3b3b': (-0.0034898914+0j), '1b2b3b4a': (-0.0207431125+0j), '1b2b3b4b': (0.0109190977+0j), '1b2b4a4a': (0.0300724961+0j), '1b2b4a4b': (-0.0044123194+0j), '1b2b4b4b': (-0.0026557878+0j), '1b3a3a3a': (0.0125040464+0j), '1b3a3a3b': (-0.1025088577+0j), '1b3a3a4a': (0.0025113326+0j), '1b3a3a4b': (0.068589584+0j), '1b3a3b3b': (0.037115544+0j), '1b3a3b4a': (-0.1161714692+0j), '1b3a3b4b': (-0.0093740183+0j), '1b3a4a4a': (-0.011256943+0j), '1b3a4a4b': (0.084472571+0j), '1b3a4b4b': (-0.0102288161+0j), '1b3b3b3b': (-0.0019387764+0j), '1b3b3b4a': (0.0277459348+0j), '1b3b3b4b': (-0.0045309319+0j), '1b3b4a4a': (-0.032502119+0j), '1b3b4a4b': (-0.0145466323+0j), '1b3b4b4b': (0.0045672247+0j), '1b4a4a4a': (-0.0043252782+0j), '1b4a4a4b': (0.0255645362+0j), '1b4a4b4b': (-0.0024135147+0j), '1b4b4b4b': (-0.0005971137+0j), '2a2a2a2a': (7.46598e-05+0j), '2a2a2a2b': (0.0092177351+0j), '2a2a2a3a': (0.0027976724+0j), '2a2a2a3b': (-0.0166396805+0j), '2a2a2a4a': (-0.0019387764+0j), '2a2a2a4b': (0.0125040464+0j), '2a2a2b2b': (-0.0632644149+0j), '2a2a2b3a': (0.0048010826+0j), '2a2a2b3b': (0.1283677208+0j), '2a2a2b4a': (0.037115544+0j), '2a2a2b4b': (-0.1025088577+0j), '2a2a3a3a': (0.0064021832+0j), '2a2a3a3b': (-0.0260872189+0j), '2a2a3a4a': (0.0034898914+0j), '2a2a3a4b': (0.0168877848+0j), '2a2a3b3b': (-0.0589593703+0j), '2a2a3b4a': (-0.0460957199+0j), '2a2a3b4b': (0.0815626111+0j), '2a2a4a4a': (-0.0035856451+0j), '2a2a4a4b': (0.0298775513+0j), '2a2a4b4b': (-0.0290926893+0j), '2a2b2b2b': (0.0092177351+0j), '2a2b2b3a': (-0.1283677208+0j), '2a2b2b3b': (-0.0048010826+0j), '2a2b2b4a': (-0.1025088577+0j), '2a2b2b4b': (0.037115544+0j), '2a2b3a3a': (-0.0260872189+0j), '2a2b3a3b': (0.267530736+0j), '2a2b3a4a': (0.0270592375+0j), '2a2b3a4b': (-0.1976413701+0j), '2a2b3b3b': (-0.0260872189+0j), '2a2b3b4a': (0.1976413701+0j), '2a2b3b4b': (-0.0270592375+0j), '2a2b4a4a': (0.0330382203+0j), '2a2b4a4b': (-0.1565197669+0j), '2a2b4b4b': (0.0330382203+0j), '2a3a3a3a': (0.0027976724+0j), '2a3a3a3b': (0.0048010826+0j), '2a3a3a4a': (0.0076589785+0j), '2a3a3a4b': (-0.0077802939+0j), '2a3a3b3b': (-0.1283677208+0j), '2a3a3b4a': (-0.0421366254+0j), '2a3a3b4b': (0.1613810976+0j), '2a3a4a4a': (0.0013646673+0j), '2a3a4a4b': (0.0190249446+0j), '2a3a4b4b': (-0.0512090902+0j), '2a3b3b3b': (0.0166396805+0j), '2a3b3b4a': (-0.0890648521+0j), '2a3b3b4b': (-0.0039311239+0j), '2a3b4a4a': (-0.0320876144+0j), '2a3b4a4b': (0.119954262+0j), '2a3b4b4b': (-0.0159197983+0j), '2a4a4a4a': (-0.0012983659+0j), '2a4a4a4b': (0.016650419+0j), '2a4a4b4b': (-0.039805856+0j), '2a4b4b4b': (0.0064864211+0j), '2b2b2b2b': (7.46598e-05+0j), '2b2b2b3a': (0.0166396805+0j), '2b2b2b3b': (-0.0027976724+0j), '2b2b2b4a': (0.0125040464+0j), '2b2b2b4b': (-0.0019387764+0j), '2b2b3a3a': (-0.0589593703+0j), '2b2b3a3b': (-0.0260872189+0j), '2b2b3a4a': (-0.0815626111+0j), '2b2b3a4b': (0.0460957199+0j), '2b2b3b3b': (0.0064021832+0j), '2b2b3b4a': (-0.0168877848+0j), '2b2b3b4b': (-0.0034898914+0j), '2b2b4a4a': (-0.0290926893+0j), '2b2b4a4b': (0.0298775513+0j), '2b2b4b4b': (-0.0035856451+0j), '2b3a3a3a': (-0.0166396805+0j), '2b3a3a3b': (0.1283677208+0j), '2b3a3a4a': (-0.0039311239+0j), '2b3a3a4b': (-0.0890648521+0j), '2b3a3b3b': (-0.0048010826+0j), '2b3a3b4a': (0.1613810976+0j), '2b3a3b4b': (-0.0421366254+0j), '2b3a4a4a': (0.0159197983+0j), '2b3a4a4b': (-0.119954262+0j), '2b3a4b4b': (0.0320876144+0j), '2b3b3b3b': (-0.0027976724+0j), '2b3b3b4a': (-0.0077802939+0j), '2b3b3b4b': (0.0076589785+0j), '2b3b4a4a': (0.0512090902+0j), '2b3b4a4b': (-0.0190249446+0j), '2b3b4b4b': (-0.0013646673+0j), '2b4a4a4a': (0.0064864211+0j), '2b4a4a4b': (-0.039805856+0j), '2b4a4b4b': (0.016650419+0j), '2b4b4b4b': (-0.0012983659+0j), '3a3a3a3a': (7.46598e-05+0j), '3a3a3a3b': (0.0092177351+0j), '3a3a3a4a': (0.0024250907+0j), '3a3a3a4b': (-0.0084256404+0j), '3a3a3b3b': (-0.0632644149+0j), '3a3a3b4a': (-0.0043851343+0j), '3a3a3b4b': (0.0749123142+0j), '3a3a4a4a': (0.0023366998+0j), '3a3a4a4b': (-0.0032009141+0j), '3a3a4b4b': (-0.0218115313+0j), '3a3b3b3b': (0.0092177351+0j), '3a3b3b4a': (-0.0749123142+0j), '3a3b3b4b': (0.0043851343+0j), '3a3b4a4a': (-0.0163038217+0j), '3a3b4a4b': (0.0945748618+0j), '3a3b4b4b': (-0.0163038217+0j), '3a4a4a4a': (0.0001667163+0j), '3a4a4a4b': (0.005887707+0j), '3a4a4b4b': (-0.0293041916+0j), '3a4b4b4b': (0.0055951751+0j), '3b3b3b3b': (7.46598e-05+0j), '3b3b3b4a': (0.0084256404+0j), '3b3b3b4b': (-0.0024250907+0j), '3b3b4a4a': (-0.0218115313+0j), '3b3b4a4b': (-0.0032009141+0j), '3b3b4b4b': (0.0023366998+0j), '3b4a4a4a': (-0.0055951751+0j), '3b4a4a4b': (0.0293041916+0j), '3b4a4b4b': (-0.005887707+0j), '3b4b4b4b': (-0.0001667163+0j), '4a4a4a4a': (-0.0001288136+0j), '4a4a4a4b': (0.0024517907+0j), '4a4a4b4b': (-0.0094112282+0j), '4a4b4b4b': (0.0024517907+0j), '4b4b4b4b': (-0.0001288136+0j)}
)

#all negative
initial_state = state_generation(basis_states, {'1a1a1a1a': (0.0006687888+0j), '1a1a1a1b': (0.0034809773+0j), '1a1a1a2a': (0.00422928+0j), '1a1a1a2b': (0.006464807+0j), '1a1a1a3a': (0.0064072837+0j), '1a1a1a3b': (0.0077762223+0j), '1a1a1a4a': (0.0049328599+0j), '1a1a1a4b': (0.005504926+0j), '1a1a1b1b': (0.0059695005+0j), '1a1a1b2a': (0.0169880841+0j), '1a1a1b2b': (0.0198899408+0j), '1a1a1b3a': (0.0242472814+0j), '1a1a1b3b': (0.0260810339+0j), '1a1a1b4a': (0.0182234235+0j), '1a1a1b4b': (0.019000598+0j), '1a1a2a2a': (0.0112717458+0j), '1a1a2a2b': (0.0293730106+0j), '1a1a2a3a': (0.0269614675+0j), '1a1a2a3b': (0.0347792619+0j), '1a1a2a4a': (0.0214916088+0j), '1a1a2a4b': (0.0246401835+0j), '1a1a2b2b': (0.0190567174+0j), '1a1a2b3a': (0.041388213+0j), '1a1a2b3b': (0.0408534124+0j), '1a1a2b4a': (0.0311715598+0j), '1a1a2b4b': (0.0311837153+0j), '1a1a3a3a': (0.0186919251+0j), '1a1a3a3b': (0.0443745293+0j), '1a1a3a4a': (0.0247986715+0j), '1a1a3a4b': (0.0311203249+0j), '1a1a3b3b': (0.02392098+0j), '1a1a3b4a': (0.0332423514+0j), '1a1a3b4b': (0.0302100723+0j), '1a1a4a4a': (0.0092356741+0j), '1a1a4a4b': (0.0212759266+0j), '1a1a4b4b': (0.0106460206+0j), '1a1b1b1b': (0.0034809773+0j), '1a1b1b2a': (0.0198899408+0j), '1a1b1b2b': (0.0169880841+0j), '1a1b1b3a': (0.0260810339+0j), '1a1b1b3b': (0.0242472814+0j), '1a1b1b4a': (0.019000598+0j), '1a1b1b4b': (0.0182234235+0j), '1a1b2a2a': (0.030743273+0j), '1a1b2a2b': (0.0625743268+0j), '1a1b2a3a': (0.0703148229+0j), '1a1b2a3b': (0.0810010107+0j), '1a1b2a4a': (0.054932701+0j), '1a1b2a4b': (0.0591036714+0j), '1a1b2b2b': (0.030743273+0j), '1a1b2b3a': (0.0810010107+0j), '1a1b2b3b': (0.0703148229+0j), '1a1b2b4a': (0.0591036714+0j), '1a1b2b4b': (0.054932701+0j), '1a1b3a3a': (0.0451410852+0j), '1a1b3a3b': (0.0953338344+0j), '1a1b3a4a': (0.058594857+0j), '1a1b3a4b': (0.069118997+0j), '1a1b3b3b': (0.0451410852+0j), '1a1b3b4a': (0.069118997+0j), '1a1b3b4b': (0.058594857+0j), '1a1b4a4a': (0.0212759266+0j), '1a1b4a4b': (0.0457877532+0j), '1a1b4b4b': (0.0212759266+0j), '1a2a2a2a': (0.0127899607+0j), '1a2a2a2b': (0.0486610116+0j), '1a2a2a3a': (0.0413239647+0j), '1a2a2a3b': (0.0567685438+0j), '1a2a2a4a': (0.034286806+0j), '1a2a2a4b': (0.0403610164+0j), '1a2a2b2b': (0.0554370857+0j), '1a2a2b3a': (0.1105809407+0j), '1a2a2b3b': (0.1173931777+0j), '1a2a2b4a': (0.0868002884+0j), '1a2a2b4b': (0.0898278809+0j), '1a2a3a3a': (0.0469212696+0j), '1a2a3a3b': (0.117270053+0j), '1a2a3a4a': (0.0644372102+0j), '1a2a3a4b': (0.0824504286+0j), '1a2a3b3b': (0.0677449593+0j), '1a2a3b4a': (0.091490309+0j), '1a2a3b4b': (0.0857745192+0j), '1a2a4a4a': (0.0247986715+0j), '1a2a4a4b': (0.058594857+0j), '1a2a4b4b': (0.0302100723+0j), '1a2b2b2b': (0.0185158439+0j), '1a2b2b3a': (0.0707782309+0j), '1a2b2b3b': (0.0572145349+0j), '1a2b2b4a': (0.0518606403+0j), '1a2b2b4b': (0.0467106831+0j), '1a2b3a3a': (0.070120266+0j), '1a2b3a3b': (0.1370528001+0j), '1a2b3a4a': (0.091490309+0j), '1a2b3a4b': (0.1041744311+0j), '1a2b3b3b': (0.0609265248+0j), '1a2b3b4a': (0.099689994+0j), '1a2b3b4b': (0.0824504286+0j), '1a2b4a4a': (0.0332423514+0j), '1a2b4a4b': (0.069118997+0j), '1a2b4b4b': (0.0311203249+0j), '1a3a3a3a': (0.0183290104+0j), '1a3a3a3b': (0.0670876648+0j), '1a3a3a4a': (0.034286806+0j), '1a3a3a4b': (0.0467106831+0j), '1a3a3b3b': (0.0718009702+0j), '1a3a3b4a': (0.0868002884+0j), '1a3a3b4b': (0.0898278809+0j), '1a3a4a4a': (0.0214916088+0j), '1a3a4a4b': (0.054932701+0j), '1a3a4b4b': (0.0311837153+0j), '1a3b3b3b': (0.0220213897+0j), '1a3b3b4a': (0.0518606403+0j), '1a3b3b4b': (0.0403610164+0j), '1a3b4a4a': (0.0311715598+0j), '1a3b4a4b': (0.0591036714+0j), '1a3b4b4b': (0.0246401835+0j), '1a4a4a4a': (0.0049328599+0j), '1a4a4a4b': (0.0182234235+0j), '1a4a4b4b': (0.019000598+0j), '1a4b4b4b': (0.005504926+0j), '1b1b1b1b': (0.0006687888+0j), '1b1b1b2a': (0.006464807+0j), '1b1b1b2b': (0.00422928+0j), '1b1b1b3a': (0.0077762223+0j), '1b1b1b3b': (0.0064072837+0j), '1b1b1b4a': (0.005504926+0j), '1b1b1b4b': (0.0049328599+0j), '1b1b2a2a': (0.0190567174+0j), '1b1b2a2b': (0.0293730106+0j), '1b1b2a3a': (0.0408534124+0j), '1b1b2a3b': (0.041388213+0j), '1b1b2a4a': (0.0311837153+0j), '1b1b2a4b': (0.0311715598+0j), '1b1b2b2b': (0.0112717458+0j), '1b1b2b3a': (0.0347792619+0j), '1b1b2b3b': (0.0269614675+0j), '1b1b2b4a': (0.0246401835+0j), '1b1b2b4b': (0.0214916088+0j), '1b1b3a3a': (0.02392098+0j), '1b1b3a3b': (0.0443745293+0j), '1b1b3a4a': (0.0302100723+0j), '1b1b3a4b': (0.0332423514+0j), '1b1b3b3b': (0.0186919251+0j), '1b1b3b4a': (0.0311203249+0j), '1b1b3b4b': (0.0247986715+0j), '1b1b4a4a': (0.0106460206+0j), '1b1b4a4b': (0.0212759266+0j), '1b1b4b4b': (0.0092356741+0j), '1b2a2a2a': (0.0185158439+0j), '1b2a2a2b': (0.0554370857+0j), '1b2a2a3a': (0.0572145349+0j), '1b2a2a3b': (0.0707782309+0j), '1b2a2a4a': (0.0467106831+0j), '1b2a2a4b': (0.0518606403+0j), '1b2a2b2b': (0.0486610116+0j), '1b2a2b3a': (0.1173931777+0j), '1b2a2b3b': (0.1105809407+0j), '1b2a2b4a': (0.0898278809+0j), '1b2a2b4b': (0.0868002884+0j), '1b2a3a3a': (0.0609265248+0j), '1b2a3a3b': (0.1370528001+0j), '1b2a3a4a': (0.0824504286+0j), '1b2a3a4b': (0.099689994+0j), '1b2a3b3b': (0.070120266+0j), '1b2a3b4a': (0.1041744311+0j), '1b2a3b4b': (0.091490309+0j), '1b2a4a4a': (0.0311203249+0j), '1b2a4a4b': (0.069118997+0j), '1b2a4b4b': (0.0332423514+0j), '1b2b2b2b': (0.0127899607+0j), '1b2b2b3a': (0.0567685438+0j), '1b2b2b3b': (0.0413239647+0j), '1b2b2b4a': (0.0403610164+0j), '1b2b2b4b': (0.034286806+0j), '1b2b3a3a': (0.0677449593+0j), '1b2b3a3b': (0.117270053+0j), '1b2b3a4a': (0.0857745192+0j), '1b2b3a4b': (0.091490309+0j), '1b2b3b3b': (0.0469212696+0j), '1b2b3b4a': (0.0824504286+0j), '1b2b3b4b': (0.0644372102+0j), '1b2b4a4a': (0.0302100723+0j), '1b2b4a4b': (0.058594857+0j), '1b2b4b4b': (0.0247986715+0j), '1b3a3a3a': (0.0220213897+0j), '1b3a3a3b': (0.0718009702+0j), '1b3a3a4a': (0.0403610164+0j), '1b3a3a4b': (0.0518606403+0j), '1b3a3b3b': (0.0670876648+0j), '1b3a3b4a': (0.0898278809+0j), '1b3a3b4b': (0.0868002884+0j), '1b3a4a4a': (0.0246401835+0j), '1b3a4a4b': (0.0591036714+0j), '1b3a4b4b': (0.0311715598+0j), '1b3b3b3b': (0.0183290104+0j), '1b3b3b4a': (0.0467106831+0j), '1b3b3b4b': (0.034286806+0j), '1b3b4a4a': (0.0311837153+0j), '1b3b4a4b': (0.054932701+0j), '1b3b4b4b': (0.0214916088+0j), '1b4a4a4a': (0.005504926+0j), '1b4a4a4b': (0.019000598+0j), '1b4a4b4b': (0.0182234235+0j), '1b4b4b4b': (0.0049328599+0j), '2a2a2a2a': (0.0053001787+0j), '2a2a2a2b': (0.0265931973+0j), '2a2a2a3a': (0.0212240992+0j), '2a2a2a3b': (0.0307429176+0j), '2a2a2a4a': (0.0183290104+0j), '2a2a2a4b': (0.0220213897+0j), '2a2a2b2b': (0.0447931614+0j), '2a2a2b3a': (0.0816590792+0j), '2a2a2b3b': (0.0934007541+0j), '2a2a2b4a': (0.0670876648+0j), '2a2a2b4b': (0.0718009702+0j), '2a2a3a3a': (0.0330196725+0j), '2a2a3a3b': (0.0860233678+0j), '2a2a3a4a': (0.0469212696+0j), '2a2a3a4b': (0.0609265248+0j), '2a2a3b3b': (0.0532085281+0j), '2a2a3b4a': (0.070120266+0j), '2a2a3b4b': (0.0677449593+0j), '2a2a4a4a': (0.0186919251+0j), '2a2a4a4b': (0.0451410852+0j), '2a2a4b4b': (0.02392098+0j), '2a2b2b2b': (0.0265931973+0j), '2a2b2b3a': (0.0934007541+0j), '2a2b2b3b': (0.0816590792+0j), '2a2b2b4a': (0.0718009702+0j), '2a2b2b4b': (0.0670876648+0j), '2a2b3a3a': (0.0860233678+0j), '2a2b3a3b': (0.1795145371+0j), '2a2b3a4a': (0.117270053+0j), '2a2b3a4b': (0.1370528001+0j), '2a2b3b3b': (0.0860233678+0j), '2a2b3b4a': (0.1370528001+0j), '2a2b3b4b': (0.117270053+0j), '2a2b4a4a': (0.0443745293+0j), '2a2b4a4b': (0.0953338344+0j), '2a2b4b4b': (0.0443745293+0j), '2a3a3a3a': (0.0212240992+0j), '2a3a3a3b': (0.0816590792+0j), '2a3a3a4a': (0.0413239647+0j), '2a3a3a4b': (0.0572145349+0j), '2a3a3b3b': (0.0934007541+0j), '2a3a3b4a': (0.1105809407+0j), '2a3a3b4b': (0.1173931777+0j), '2a3a4a4a': (0.0269614675+0j), '2a3a4a4b': (0.0703148229+0j), '2a3a4b4b': (0.0408534124+0j), '2a3b3b3b': (0.0307429176+0j), '2a3b3b4a': (0.0707782309+0j), '2a3b3b4b': (0.0567685438+0j), '2a3b4a4a': (0.041388213+0j), '2a3b4a4b': (0.0810010107+0j), '2a3b4b4b': (0.0347792619+0j), '2a4a4a4a': (0.0064072837+0j), '2a4a4a4b': (0.0242472814+0j), '2a4a4b4b': (0.0260810339+0j), '2a4b4b4b': (0.0077762223+0j), '2b2b2b2b': (0.0053001787+0j), '2b2b2b3a': (0.0307429176+0j), '2b2b2b3b': (0.0212240992+0j), '2b2b2b4a': (0.0220213897+0j), '2b2b2b4b': (0.0183290104+0j), '2b2b3a3a': (0.0532085281+0j), '2b2b3a3b': (0.0860233678+0j), '2b2b3a4a': (0.0677449593+0j), '2b2b3a4b': (0.070120266+0j), '2b2b3b3b': (0.0330196725+0j), '2b2b3b4a': (0.0609265248+0j), '2b2b3b4b': (0.0469212696+0j), '2b2b4a4a': (0.02392098+0j), '2b2b4a4b': (0.0451410852+0j), '2b2b4b4b': (0.0186919251+0j), '2b3a3a3a': (0.0307429176+0j), '2b3a3a3b': (0.0934007541+0j), '2b3a3a4a': (0.0567685438+0j), '2b3a3a4b': (0.0707782309+0j), '2b3a3b3b': (0.0816590792+0j), '2b3a3b4a': (0.1173931777+0j), '2b3a3b4b': (0.1105809407+0j), '2b3a4a4a': (0.0347792619+0j), '2b3a4a4b': (0.0810010107+0j), '2b3a4b4b': (0.041388213+0j), '2b3b3b3b': (0.0212240992+0j), '2b3b3b4a': (0.0572145349+0j), '2b3b3b4b': (0.0413239647+0j), '2b3b4a4a': (0.0408534124+0j), '2b3b4a4b': (0.0703148229+0j), '2b3b4b4b': (0.0269614675+0j), '2b4a4a4a': (0.0077762223+0j), '2b4a4a4b': (0.0260810339+0j), '2b4a4b4b': (0.0242472814+0j), '2b4b4b4b': (0.0064072837+0j), '3a3a3a3a': (0.0053001787+0j), '3a3a3a3b': (0.0265931973+0j), '3a3a3a4a': (0.0127899607+0j), '3a3a3a4b': (0.0185158439+0j), '3a3a3b3b': (0.0447931614+0j), '3a3a3b4a': (0.0486610116+0j), '3a3a3b4b': (0.0554370857+0j), '3a3a4a4a': (0.0112717458+0j), '3a3a4a4b': (0.030743273+0j), '3a3a4b4b': (0.0190567174+0j), '3a3b3b3b': (0.0265931973+0j), '3a3b3b4a': (0.0554370857+0j), '3a3b3b4b': (0.0486610116+0j), '3a3b4a4a': (0.0293730106+0j), '3a3b4a4b': (0.0625743268+0j), '3a3b4b4b': (0.0293730106+0j), '3a4a4a4a': (0.00422928+0j), '3a4a4a4b': (0.0169880841+0j), '3a4a4b4b': (0.0198899408+0j), '3a4b4b4b': (0.006464807+0j), '3b3b3b3b': (0.0053001787+0j), '3b3b3b4a': (0.0185158439+0j), '3b3b3b4b': (0.0127899607+0j), '3b3b4a4a': (0.0190567174+0j), '3b3b4a4b': (0.030743273+0j), '3b3b4b4b': (0.0112717458+0j), '3b4a4a4a': (0.006464807+0j), '3b4a4a4b': (0.0198899408+0j), '3b4a4b4b': (0.0169880841+0j), '3b4b4b4b': (0.00422928+0j), '4a4a4a4a': (0.0006687888+0j), '4a4a4a4b': (0.0034809773+0j), '4a4a4b4b': (0.0059695005+0j), '4a4b4b4b': (0.0034809773+0j), '4b4b4b4b': (0.0006687888+0j)}
)

#all negative, one positive
initial_state = state_generation(basis_states, {'1a1a1a1a': (-0.0001288136+0j), '1a1a1a1b': (-0.0024517907+0j), '1a1a1a2a': (-0.0001667163+0j), '1a1a1a2b': (-0.0055951751+0j), '1a1a1a3a': (-0.0012983659+0j), '1a1a1a3b': (-0.0064864211+0j), '1a1a1a4a': (-0.0005971137+0j), '1a1a1a4b': (-0.0043252782+0j), '1a1a1b1b': (-0.0094112282+0j), '1a1a1b2a': (0.005887707+0j), '1a1a1b2b': (-0.0293041916+0j), '1a1a1b3a': (-0.016650419+0j), '1a1a1b3b': (-0.039805856+0j), '1a1a1b4a': (0.0024135147+0j), '1a1a1b4b': (-0.0255645362+0j), '1a1a2a2a': (0.0023366998+0j), '1a1a2a2b': (0.0163038217+0j), '1a1a2a3a': (-0.0013646673+0j), '1a1a2a3b': (0.0159197983+0j), '1a1a2a4a': (0.0045672247+0j), '1a1a2a4b': (0.011256943+0j), '1a1a2b2b': (-0.0218115313+0j), '1a1a2b3a': (-0.0320876144+0j), '1a1a2b3b': (-0.0512090902+0j), '1a1a2b4a': (0.0102288161+0j), '1a1a2b4b': (-0.032502119+0j), '1a1a3a3a': (-0.0035856451+0j), '1a1a3a3b': (-0.0330382203+0j), '1a1a3a4a': (-0.0026557878+0j), '1a1a3a4b': (-0.0224713829+0j), '1a1a3b3b': (-0.0290926893+0j), '1a1a3b4a': (0.011704268+0j), '1a1a3b4b': (-0.0300724961+0j), '1a1a4a4a': (0.0022873491+0j), '1a1a4a4b': (0.0099650011+0j), '1a1a4b4b': (-0.0075134083+0j), '1a1b1b1b': (-0.0024517907+0j), '1a1b1b2a': (0.0293041916+0j), '1a1b1b2b': (-0.005887707+0j), '1a1b1b3a': (-0.039805856+0j), '1a1b1b3b': (-0.016650419+0j), '1a1b1b4a': (0.0255645362+0j), '1a1b1b4b': (-0.0024135147+0j), '1a1b2a2a': (0.0032009141+0j), '1a1b2a2b': (0.0945748618+0j), '1a1b2a3a': (0.0190249446+0j), '1a1b2a3b': (0.119954262+0j), '1a1b2a4a': (0.0145466323+0j), '1a1b2a4b': (0.084472571+0j), '1a1b2b2b': (0.0032009141+0j), '1a1b2b3a': (-0.119954262+0j), '1a1b2b3b': (-0.0190249446+0j), '1a1b2b4a': (0.084472571+0j), '1a1b2b4b': (0.0145466323+0j), '1a1b3a3a': (-0.0298775513+0j), '1a1b3a3b': (-0.1565197669+0j), '1a1b3a4a': (0.0044123194+0j), '1a1b3a4b': (-0.1031824802+0j), '1a1b3b3b': (-0.0298775513+0j), '1a1b3b4a': (0.1031824802+0j), '1a1b3b4b': (-0.0044123194+0j), '1a1b4a4a': (0.0099650011+0j), '1a1b4a4b': (0.074163922+0j), '1a1b4b4b': (0.0099650011+0j), '1a2a2a2a': (-0.0024250907+0j), '1a2a2a2b': (-0.0043851343+0j), '1a2a2a3a': (0.0076589785+0j), '1a2a2a3b': (0.0039311239+0j), '1a2a2a4a': (-0.0045309319+0j), '1a2a2a4b': (0.0025113326+0j), '1a2a2b2b': (0.0749123142+0j), '1a2a2b3a': (0.0421366254+0j), '1a2a2b3b': (0.1613810976+0j), '1a2a2b4a': (0.0093740183+0j), '1a2a2b4b': (0.1161714692+0j), '1a2a3a3a': (-0.0034898914+0j), '1a2a3a3b': (0.0270592375+0j), '1a2a3a4a': (0.0109190977+0j), '1a2a3a4b': (0.0207431125+0j), '1a2a3b3b': (0.0815626111+0j), '1a2a3b4a': (0.01397448+0j), '1a2a3b4b': (0.0980316525+0j), '1a2a4a4a': (-0.0026557878+0j), '1a2a4a4b': (0.0044123194+0j), '1a2a4b4b': (0.0300724961+0j), '1a2b2b2b': (0.0084256404+0j), '1a2b2b3a': (-0.0890648521+0j), '1a2b2b3b': (0.0077802939+0j), '1a2b2b4a': (0.068589584+0j), '1a2b2b4b': (0.0277459348+0j), '1a2b3a3a': (-0.0460957199+0j), '1a2b3a3b': (-0.1976413701+0j), '1a2b3a4a': (0.01397448+0j), '1a2b3a4b': (-0.1344413254+0j), '1a2b3b3b': (-0.0168877848+0j), '1a2b3b4a': (0.1396712889+0j), '1a2b3b4b': (0.0207431125+0j), '1a2b4a4a': (0.011704268+0j), '1a2b4a4b': (0.1031824802+0j), '1a2b4b4b': (0.0224713829+0j), '1a3a3a3a': (-0.0019387764+0j), '1a3a3a3b': (-0.037115544+0j), '1a3a3a4a': (-0.0045309319+0j), '1a3a3a4b': (-0.0277459348+0j), '1a3a3b3b': (-0.1025088577+0j), '1a3a3b4a': (0.0093740183+0j), '1a3a3b4b': (-0.1161714692+0j), '1a3a4a4a': (0.0045672247+0j), '1a3a4a4b': (0.0145466323+0j), '1a3a4b4b': (-0.032502119+0j), '1a3b3b3b': (-0.0125040464+0j), '1a3b3b4a': (0.068589584+0j), '1a3b3b4b': (-0.0025113326+0j), '1a3b4a4a': (0.0102288161+0j), '1a3b4a4b': (0.084472571+0j), '1a3b4b4b': (0.011256943+0j), '1a4a4a4a': (-0.0005971137+0j), '1a4a4a4b': (0.0024135147+0j), '1a4a4b4b': (0.0255645362+0j), '1a4b4b4b': (0.0043252782+0j), '1b1b1b1b': (-0.0001288136+0j), '1b1b1b2a': (0.0055951751+0j), '1b1b1b2b': (0.0001667163+0j), '1b1b1b3a': (-0.0064864211+0j), '1b1b1b3b': (-0.0012983659+0j), '1b1b1b4a': (0.0043252782+0j), '1b1b1b4b': (0.0005971137+0j), '1b1b2a2a': (-0.0218115313+0j), '1b1b2a2b': (0.0163038217+0j), '1b1b2a3a': (0.0512090902+0j), '1b1b2a3b': (0.0320876144+0j), '1b1b2a4a': (-0.032502119+0j), '1b1b2a4b': (0.0102288161+0j), '1b1b2b2b': (0.0023366998+0j), '1b1b2b3a': (-0.0159197983+0j), '1b1b2b3b': (0.0013646673+0j), '1b1b2b4a': (0.011256943+0j), '1b1b2b4b': (0.0045672247+0j), '1b1b3a3a': (-0.0290926893+0j), '1b1b3a3b': (-0.0330382203+0j), '1b1b3a4a': (0.0300724961+0j), '1b1b3a4b': (-0.011704268+0j), '1b1b3b3b': (-0.0035856451+0j), '1b1b3b4a': (0.0224713829+0j), '1b1b3b4b': (0.0026557878+0j), '1b1b4a4a': (-0.0075134083+0j), '1b1b4a4b': (0.0099650011+0j), '1b1b4b4b': (0.0022873491+0j), '1b2a2a2a': (-0.0084256404+0j), '1b2a2a2b': (-0.0749123142+0j), '1b2a2a3a': (0.0077802939+0j), '1b2a2a3b': (-0.0890648521+0j), '1b2a2a4a': (-0.0277459348+0j), '1b2a2a4b': (-0.068589584+0j), '1b2a2b2b': (0.0043851343+0j), '1b2a2b3a': (0.1613810976+0j), '1b2a2b3b': (0.0421366254+0j), '1b2a2b4a': (-0.1161714692+0j), '1b2a2b4b': (-0.0093740183+0j), '1b2a3a3a': (0.0168877848+0j), '1b2a3a3b': (0.1976413701+0j), '1b2a3a4a': (0.0207431125+0j), '1b2a3a4b': (0.1396712889+0j), '1b2a3b3b': (0.0460957199+0j), '1b2a3b4a': (-0.1344413254+0j), '1b2a3b4b': (0.01397448+0j), '1b2a4a4a': (-0.0224713829+0j), '1b2a4a4b': (-0.1031824802+0j), '1b2a4b4b': (-0.011704268+0j), '1b2b2b2b': (0.0024250907+0j), '1b2b2b3a': (0.0039311239+0j), '1b2b2b3b': (0.0076589785+0j), '1b2b2b4a': (-0.0025113326+0j), '1b2b2b4b': (0.0045309319+0j), '1b2b3a3a': (-0.0815626111+0j), '1b2b3a3b': (-0.0270592375+0j), '1b2b3a4a': (0.0980316525+0j), '1b2b3a4b': (0.01397448+0j), '1b2b3b3b': (0.0034898914+0j), '1b2b3b4a': (0.0207431125+0j), '1b2b3b4b': (0.0109190977+0j), '1b2b4a4a': (-0.0300724961+0j), '1b2b4a4b': (-0.0044123194+0j), '1b2b4b4b': (0.0026557878+0j), '1b3a3a3a': (-0.0125040464+0j), '1b3a3a3b': (-0.1025088577+0j), '1b3a3a4a': (0.0025113326+0j), '1b3a3a4b': (-0.068589584+0j), '1b3a3b3b': (-0.037115544+0j), '1b3a3b4a': (0.1161714692+0j), '1b3a3b4b': (-0.0093740183+0j), '1b3a4a4a': (0.011256943+0j), '1b3a4a4b': (0.084472571+0j), '1b3a4b4b': (0.0102288161+0j), '1b3b3b3b': (-0.0019387764+0j), '1b3b3b4a': (0.0277459348+0j), '1b3b3b4b': (0.0045309319+0j), '1b3b4a4a': (-0.032502119+0j), '1b3b4a4b': (0.0145466323+0j), '1b3b4b4b': (0.0045672247+0j), '1b4a4a4a': (-0.0043252782+0j), '1b4a4a4b': (-0.0255645362+0j), '1b4a4b4b': (-0.0024135147+0j), '1b4b4b4b': (0.0005971137+0j), '2a2a2a2a': (7.46598e-05+0j), '2a2a2a2b': (-0.0092177351+0j), '2a2a2a3a': (-0.0027976724+0j), '2a2a2a3b': (-0.0166396805+0j), '2a2a2a4a': (-0.0019387764+0j), '2a2a2a4b': (-0.0125040464+0j), '2a2a2b2b': (-0.0632644149+0j), '2a2a2b3a': (0.0048010826+0j), '2a2a2b3b': (-0.1283677208+0j), '2a2a2b4a': (-0.037115544+0j), '2a2a2b4b': (-0.1025088577+0j), '2a2a3a3a': (0.0064021832+0j), '2a2a3a3b': (0.0260872189+0j), '2a2a3a4a': (-0.0034898914+0j), '2a2a3a4b': (0.0168877848+0j), '2a2a3b3b': (-0.0589593703+0j), '2a2a3b4a': (-0.0460957199+0j), '2a2a3b4b': (-0.0815626111+0j), '2a2a4a4a': (-0.0035856451+0j), '2a2a4a4b': (-0.0298775513+0j), '2a2a4b4b': (-0.0290926893+0j), '2a2b2b2b': (-0.0092177351+0j), '2a2b2b3a': (0.1283677208+0j), '2a2b2b3b': (-0.0048010826+0j), '2a2b2b4a': (-0.1025088577+0j), '2a2b2b4b': (-0.037115544+0j), '2a2b3a3a': (0.0260872189+0j), '2a2b3a3b': (0.267530736+0j), '2a2b3a4a': (0.0270592375+0j), '2a2b3a4b': (0.1976413701+0j), '2a2b3b3b': (0.0260872189+0j), '2a2b3b4a': (-0.1976413701+0j), '2a2b3b4b': (-0.0270592375+0j), '2a2b4a4a': (-0.0330382203+0j), '2a2b4a4b': (-0.1565197669+0j), '2a2b4b4b': (-0.0330382203+0j), '2a3a3a3a': (-0.0027976724+0j), '2a3a3a3b': (0.0048010826+0j), '2a3a3a4a': (0.0076589785+0j), '2a3a3a4b': (0.0077802939+0j), '2a3a3b3b': (0.1283677208+0j), '2a3a3b4a': (0.0421366254+0j), '2a3a3b4b': (0.1613810976+0j), '2a3a4a4a': (-0.0013646673+0j), '2a3a4a4b': (0.0190249446+0j), '2a3a4b4b': (0.0512090902+0j), '2a3b3b3b': (0.0166396805+0j), '2a3b3b4a': (-0.0890648521+0j), '2a3b3b4b': (0.0039311239+0j), '2a3b4a4a': (-0.0320876144+0j), '2a3b4a4b': (-0.119954262+0j), '2a3b4b4b': (-0.0159197983+0j), '2a4a4a4a': (-0.0012983659+0j), '2a4a4a4b': (-0.016650419+0j), '2a4a4b4b': (-0.039805856+0j), '2a4b4b4b': (-0.0064864211+0j), '2b2b2b2b': (7.46598e-05+0j), '2b2b2b3a': (0.0166396805+0j), '2b2b2b3b': (0.0027976724+0j), '2b2b2b4a': (-0.0125040464+0j), '2b2b2b4b': (-0.0019387764+0j), '2b2b3a3a': (-0.0589593703+0j), '2b2b3a3b': (0.0260872189+0j), '2b2b3a4a': (0.0815626111+0j), '2b2b3a4b': (0.0460957199+0j), '2b2b3b3b': (0.0064021832+0j), '2b2b3b4a': (-0.0168877848+0j), '2b2b3b4b': (0.0034898914+0j), '2b2b4a4a': (-0.0290926893+0j), '2b2b4a4b': (-0.0298775513+0j), '2b2b4b4b': (-0.0035856451+0j), '2b3a3a3a': (-0.0166396805+0j), '2b3a3a3b': (-0.1283677208+0j), '2b3a3a4a': (0.0039311239+0j), '2b3a3a4b': (-0.0890648521+0j), '2b3a3b3b': (-0.0048010826+0j), '2b3a3b4a': (0.1613810976+0j), '2b3a3b4b': (0.0421366254+0j), '2b3a4a4a': (0.0159197983+0j), '2b3a4a4b': (0.119954262+0j), '2b3a4b4b': (0.0320876144+0j), '2b3b3b3b': (0.0027976724+0j), '2b3b3b4a': (0.0077802939+0j), '2b3b3b4b': (0.0076589785+0j), '2b3b4a4a': (-0.0512090902+0j), '2b3b4a4b': (-0.0190249446+0j), '2b3b4b4b': (0.0013646673+0j), '2b4a4a4a': (-0.0064864211+0j), '2b4a4a4b': (-0.039805856+0j), '2b4a4b4b': (-0.016650419+0j), '2b4b4b4b': (-0.0012983659+0j), '3a3a3a3a': (7.46598e-05+0j), '3a3a3a3b': (-0.0092177351+0j), '3a3a3a4a': (-0.0024250907+0j), '3a3a3a4b': (-0.0084256404+0j), '3a3a3b3b': (-0.0632644149+0j), '3a3a3b4a': (-0.0043851343+0j), '3a3a3b4b': (-0.0749123142+0j), '3a3a4a4a': (0.0023366998+0j), '3a3a4a4b': (0.0032009141+0j), '3a3a4b4b': (-0.0218115313+0j), '3a3b3b3b': (-0.0092177351+0j), '3a3b3b4a': (0.0749123142+0j), '3a3b3b4b': (0.0043851343+0j), '3a3b4a4a': (0.0163038217+0j), '3a3b4a4b': (0.0945748618+0j), '3a3b4b4b': (0.0163038217+0j), '3a4a4a4a': (-0.0001667163+0j), '3a4a4a4b': (0.005887707+0j), '3a4a4b4b': (0.0293041916+0j), '3a4b4b4b': (0.0055951751+0j), '3b3b3b3b': (7.46598e-05+0j), '3b3b3b4a': (0.0084256404+0j), '3b3b3b4b': (0.0024250907+0j), '3b3b4a4a': (-0.0218115313+0j), '3b3b4a4b': (0.0032009141+0j), '3b3b4b4b': (0.0023366998+0j), '3b4a4a4a': (-0.0055951751+0j), '3b4a4a4b': (-0.0293041916+0j), '3b4a4b4b': (-0.005887707+0j), '3b4b4b4b': (0.0001667163+0j), '4a4a4a4a': (-0.0001288136+0j), '4a4a4a4b': (-0.0024517907+0j), '4a4a4b4b': (-0.0094112282+0j), '4a4b4b4b': (-0.0024517907+0j), '4b4b4b4b': (-0.0001288136+0j)}
)




#~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

print(initial_state)
print(basis_states)
print(len(basis_states))


eigenstates = False
max_number_of_states = 0
time_evolution = True
Fock_Space_Measure = False  #If false, prints occupation in the basis_label spatial occupation
t = np.linspace(0,0.5, 100) #in us


detuning_measurement = 100 * g

Measure_currents = False
analytic_currents = False

current_measurements = [['1a', '1b'], ['2a', '2b'], ['3a', '3b']]
# current_measurements = [['1a', '2a'], ['1b', '2b']]

skip_number = 80  #if 1, then do all of them. if 10, then every 10 times
Measure_correlations = False
analytic_correlations = True

current_correlations = [['1a', '1b'], ['2a', '2b']]
current_correlations = [['1a', '1b'], ['3a', '3b']]
current_correlations = [['1a', '1b'], ['4a', '4b']]

# current_correlations = [['1a', '2a'], ['1b', '2b']]

# correlation_values = {'1a1b': 1, '1b2a': -1, '1a2b': -1, '2a2b': 1}
time_beam = 2 * np.pi / (8 * g)

energy_map = {}
for key in basis_labels:
    if key not in energy_map.keys():
        energy_map[key] = e

energy_map.update((key, value * 2 * np.pi) for key, value in energy_map.items())#

H = Hamiltonian(basis_states, U, energy_map, coupling_dictionary_same,
                         coupling_dictionary_NN, coupling_periodic)
Evolution_H = copy.copy(H.H)

U = -150 *0
current_Hamiltonians = []
for c_m in current_measurements:
    H2 = Hamiltonian(basis_states, U, energy_map, coupling_dictionary_same,
                    coupling_dictionary_NN, coupling_periodic)
    Hamm = H_beamsplitter(c_m, detuning_measurement, H2, energy_map)
    current_Hamiltonians.append(copy.copy(Hamm))

H3 = Hamiltonian(basis_states, U, energy_map, coupling_dictionary_same,
                coupling_dictionary_NN, coupling_periodic)
Hamm = H_Beamsplitter_Correlation(current_correlations, detuning_measurement, H3, energy_map)
correlation_Hamiltonian = copy.copy(Hamm)
print(correlation_Hamiltonian)

if time_evolution:
    sol = odeintw(function_vector, initial_state, t, args=(Evolution_H,), full_output = 1)[0]
    sol_copy = copy.copy(sol)
    if Fock_Space_Measure:
        all_exp_values = Expectation_values(sol, values_to_see, basis_states).real
        vmax = 1
    else:
        values_to_see = basis_labels
        all_exp_values = Expectation_values_basis_labels(sol, values_to_see, basis_states).real
        vmax = len(basis_states[0]) / len(basis_labels[0])

    # current = all_exp_values[1] - all_exp_values[0]

    plt.figure(figsize=([15, 8]))
    for i, exp in enumerate(all_exp_values):
        plt.plot(t[:None], exp[:None], label = str(values_to_see[i]))
    total_sum = np.array(all_exp_values[0])
    for i in range(len(all_exp_values[1:])):
        total_sum += np.array(all_exp_values[i + 1])
    # plt.plot(t[:None], total_sum[:None], label = 'Sum')
    plt.xlabel('Time (us)')
    plt.ylabel('Population')
    plt.legend(loc = 'upper right')
    plt.show()

    plt.figure(figsize = ([13, 15]))
    step = t[1] - t[0]
    plt.imshow(np.array(all_exp_values).T, vmin=0, vmax=vmax, aspect = 'auto',
               origin  = 'lower', interpolation = 'none', extent = (0.5, len(all_exp_values) + 0.5, t[0] - step/2, t[-1] + step/2),
               cmap = 'magma')
    plt.locator_params(axis='x', nbins=4)
    plt.ylabel('Time (us)')
    plt.xlabel('Qubit Number')
    plt.colorbar(label = 'Qubit Population')
    plt.show()

    if analytic_currents:
        Current_obj = Current_Operator(basis_states, basis_labels, ['1a'], ['1c'])
        updated_times = []
        Time_currents = [[] for i in range(len(current_measurements))]
        time_skips = skip_number

        for i, t_step in enumerate(t):
            if i % time_skips != 0:
                continue
            updated_times.append(t[i])
            initial_state = sol_copy[i, :]
            for j, c_meas in enumerate(current_measurements):
                op1 = Current_obj.operator_measurement(initial_state,
                                                       [c_meas[0]],
                                                       [c_meas[1]])
                op2 = Current_obj.operator_measurement(initial_state,
                                                       [c_meas[1]],
                                                       [c_meas[0]])
                Time_currents[j].append(1j * (op1 - op2))

        Time_currents = np.array(Time_currents)

        plt.figure(figsize=([15, 8]))
        for i, exp in enumerate(Time_currents):
            plt.plot(updated_times[:None], exp.real[:None], label=str(current_measurements[i]))
            # plt.plot(updated_times[:None], exp.imag[:None], label=str(current_measurements[i]) + 'imag')
        plt.legend(loc='upper right')
        plt.xlabel('Time (us)')
        plt.ylabel('Current')
        plt.title('Analytic')
        plt.show()

    if Measure_currents:
        t_beam = np.linspace(0, time_beam, 100)
        time_skips = skip_number
        if time_skips < 1:
            time_skips == 1
        occupation_numbers = [[] for i in range(len(current_measurements))]
        updated_times = []
        for i, t_step in enumerate(t):
            if i % time_skips != 0:
                continue
            updated_times.append(t[i])
            initial_state = sol_copy[i, :]
            for j, Ham_c in enumerate(current_Hamiltonians):
                sol_j = odeintw(function_vector, initial_state, t_beam, args=(Ham_c,), full_output=1)[0]
                values_to_see = current_measurements[j]
                all_exp_values = Expectation_values_basis_labels(sol_j, values_to_see, basis_states).real
                vmax = len(basis_states[0]) / len(basis_labels[0])
                final_values = all_exp_values[:, -1]
                occupation_numbers[j].append(final_values[1] - final_values[0])

        plt.figure(figsize=([15, 8]))
        for i, exp in enumerate(occupation_numbers):
            plt.plot(updated_times[:None], exp[:None], label=str(current_measurements[i]))

        plt.legend(loc='upper right')
        plt.xlabel('Time (us)')
        plt.ylabel('Current')
        plt.show()

    if analytic_correlations:
        Current_obj = Current_Operator(basis_states, basis_labels, ['1a', '1b'], ['1c', '2a'])

        updated_times = []
        Time_correlations = []
        time_skips = skip_number

        for i, t_step in enumerate(t):
            if i % time_skips != 0:
                continue
            updated_times.append(t[i])
            initial_state = sol_copy[i, :]
            op1 = Current_obj.operator_measurement(initial_state, [current_correlations[0][0], current_correlations[1][0]],
                                                   [current_correlations[0][1], current_correlations[1][1]])
            op2 = Current_obj.operator_measurement(initial_state, [current_correlations[0][0], current_correlations[1][1]],
                                                   [current_correlations[0][1], current_correlations[1][0]])
            op3 = Current_obj.operator_measurement(initial_state, [current_correlations[0][1], current_correlations[1][0]],
                                                   [current_correlations[0][0], current_correlations[1][1]])
            op4 = Current_obj.operator_measurement(initial_state, [current_correlations[0][1], current_correlations[1][1]],
                                                   [current_correlations[0][0], current_correlations[1][0]])

            Time_correlations.append(-1 * (op1 - op2 - op3 + op4))

        Time_correlations = np.array(Time_correlations)
        print('Correlation Number: ', Time_correlations[0])

        plt.figure(figsize=([15, 8]))
        plt.plot(updated_times[:None], Time_correlations.real[:None], label = 'Real')
        # plt.plot(updated_times[:None], Time_correlations.imag[:None], label = 'Imag')
        plt.xlabel('Time (us)')
        plt.ylabel('Current Correlation')
        plt.title('Analytic')
        plt.ylim(min(Time_correlations) - 0.1, max(Time_correlations) + 0.1)
        plt.show()

    if Measure_correlations:
        values_to_see = np.concatenate(current_correlations)
        values_to_see = [[current_correlations[0][0], current_correlations[1][0]],
                         [current_correlations[0][0], current_correlations[1][1]],
                         [current_correlations[0][1], current_correlations[1][0]],
                         [current_correlations[0][1], current_correlations[1][1]]]

        t_beam = np.linspace(0, time_beam, 100)
        time_skips = skip_number
        if time_skips < 1:
            time_skips == 1
        occupation_numbers = []
        occupation_numbers_individual = [[] for i in list(values_to_see)]
        updated_times = []
        for i, t_step in enumerate(t):
            if i % time_skips != 0:
                continue
            updated_times.append(t[i])
            initial_state = sol_copy[i, :]
            sol_j = odeintw(function_vector, initial_state, t_beam, args=(correlation_Hamiltonian,), full_output=1)[0]
            all_exp_values = Expectation_values_basis_labels(sol_j, values_to_see, basis_states).real
            final_values = all_exp_values[:, -1]
            # sum_final_values = (final_values[1] - final_values[0]) * (final_values[3] - final_values[2])
            sum_final_values = (final_values[0] + final_values[3] - final_values[1] - final_values[2])
            for k, val in enumerate(values_to_see):
                occupation_numbers_individual[k].append(final_values[k])
            occupation_numbers.append(sum_final_values)

        # plt.figure(figsize=([15, 8]))
        # for i, exp in enumerate(occupation_numbers_individual):
        #     plt.plot(updated_times[:None], exp[:None], label=str(values_to_see[i]))
        #
        # plt.legend(loc='upper right')
        # plt.xlabel('Time (us)')
        # plt.ylabel('Current')
        # plt.show()

        occupation_numbers = np.array(occupation_numbers)
        plt.figure(figsize=([15, 8]))
        plt.plot(updated_times[:None], occupation_numbers[:None])

        # plt.legend(loc='upper right')
        plt.xlabel('Time (us)')
        plt.ylabel('Current Correlation')
        plt.ylim(min(occupation_numbers) - 0.1, max(occupation_numbers) + 0.1)
        plt.show()
if eigenstates:
    print('Hamiltonian real:')
    print(np.round(H.H.real / 1, 3))
    print('Hamiltonian imaginary:')
    print(np.round(H.H.imag / 1, 3))

    eigval, eigvect = np.linalg.eig(H.H)
    sorted_eig = []
    for k, val in enumerate(eigval):
        sorted_eig.append((val, k))
    sorted_eig.sort()

    print(np.round(np.array(np.real(sorted_eig))[:, 0] / 1, 5))
    for i in range(len(sorted_eig)):
        if i > max_number_of_states:
            continue
        print(np.round(np.real(sorted_eig[i][0]) / 1, 5))
        dictionary_eigenstate_initial = {}
        for j in range(len(basis_states)):
            print(basis_states[j] + ': ', np.round(eigvect[j, sorted_eig[i][1]] , 10))
            dictionary_eigenstate_initial[basis_states[j]] = np.round(eigvect[j, sorted_eig[i][1]] , 10)
        print(dictionary_eigenstate_initial)